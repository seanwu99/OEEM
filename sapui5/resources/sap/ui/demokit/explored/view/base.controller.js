/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2017 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/mvc/Controller","jquery.sap.storage"],function(C,q){"use strict";return C.extend("sap.ui.demokit.explored.view.base",{_oViewSettings:null,_oStorage:q.sap.storage(q.sap.storage.Type.local),_sStorageKey:"UI5_EXPLORED_VIEW_SETTINGS",_oDefaultSettings:{filter:{},groupProperty:"category",groupDescending:false,compactOn:false,themeActive:"sap_belize",rtl:false,version:q.sap.Version(sap.ui.version).getMajor()+"."+q.sap.Version(sap.ui.version).getMinor()},_applyViewConfigurations:function(){if(!this._oViewSettings){this._initViewSettings();this.getOwnerComponent().getEventBus().publish("app","applyAppConfiguration",{themeActive:this._oViewSettings.themeActive,compactOn:this._oViewSettings.compactOn});}},_initViewSettings:function(){var j=this._oStorage.get(this._sStorageKey);if(!j){this._oViewSettings=this._oDefaultSettings;}else{this._oViewSettings=JSON.parse(j);var f=this.getOwnerComponent().getModel("filter").getData();var c={};q.each(this._oViewSettings.filter,function(p,V){var n=[];q.each(V,function(i,a){var b=false;q.each(f[p],function(i,o){if(o.id===a){b=true;return false;}});if(b){n.push(a);}});if(n.length>0){c[p]=n;}});this._oViewSettings.filter=c;if(!this._oViewSettings.hasOwnProperty("compactOn")){this._oViewSettings.compactOn=false;}if(!this._oViewSettings.hasOwnProperty("themeActive")){this._oViewSettings.themeActive="sap_bluecrystal";}else if(this._oViewSettings.version!==this._oDefaultSettings.version){var v=q.sap.Version(sap.ui.version);if(v.compareTo("1.40.0")>=0){this._oViewSettings.themeActive="sap_belize";}else{this._oViewSettings.themeActive="sap_bluecrystal";}}if(!this._oViewSettings.hasOwnProperty("rtl")){this._oViewSettings.rtl=false;}if(this._oViewSettings.rtl&&!q.sap.getUriParameters().get('sap-ui-rtl')){this._handleRTL(true);}}},_handleRTL:function(s){q.sap.require("sap.ui.core.routing.HashChanger");var H=sap.ui.require("sap/ui/core/routing/HashChanger");var h=new H();var a=h.getHash();var u=window.location;if(!window.location.origin){window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?':'+window.location.port:'');}if(s){window.location=u.origin+u.pathname+"?sap-ui-rtl=true#"+a;}else{window.location=u.origin+u.pathname+"#/"+a;}}});});
